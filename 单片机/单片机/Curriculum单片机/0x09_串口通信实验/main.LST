C51 COMPILER V9.54   MAIN                                                                  05/06/2024 11:29:45 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN main.OBJ
COMPILER INVOKED BY: E:\KeilC51\C51\BIN\C51.EXE main.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND

line level    source

   1          /**************************************************************************************
   2          ͨʵ
   3          
   4           : bits/s, 2400, 4800, 9600, Ƽ 9600
   5                           96 - N - 8 - 1
   6          
   7          ʵس󣬵ַݸƬƬԭⲻתʾ
   8          עʹûɫñCH340ԵP5ӵUTXP30̽ӣURXP31̽ӣĬѶ̽Ӻ                                                                                                                                                 
             -          
   9          ***************************************************************************************/
  10          #include "reg52.h"
  11          
  12          typedef unsigned int u16;        
  13          typedef unsigned char u8;
  14          
  15          // ͨжúͨTHTLȷʱʱ
  16          // baudʶӦTHTLװֵ
  17          void uart_init(u8 baud) {
  18   1              /*
  19   1              8051ƬУͨͨʱʵֵġ
  20   1              ʱĹʽMode˶ʱĹģʽͼʽ
  21   1              ڴͨУҪʹöʱɲʣԱⲿ豸ȷͨš
  22   1              ˣҪʱΪȷĹʽȷĲʡ
  23   1              ʾУǽʱ1TMODΪʽ2һ8λԶģʽ
  24   1              ֹʽڴͨţΪԸݶʱȷĲʡ
  25   1              ͨ趨 TH1  TL1 ĳֵǿʵĲʣ TH1  TL1 ֵ趨Ϊ9600
  26   1              ԣ TMOD ĹʽΪϴͨŵȷʱܹȷĲʣʵȷͨ
             -ʡ
  27   1              */ 
  28   1              
  29   1              /*
  30   1                      ʱ/ģʽĴ TMOD
  31   1              */
  32   1              TMOD |= 0X20;   //üʽ2, M1 = 0, M0 = 0, ڲ
  33   1              
  34   1              /* 
  35   1                      ڿƼĴ SCON 
  36   1                  SM0 SM1 SM2 REN TB8 RB8 TI RI
  37   1                      ʽ 1 : SM0 = 0, SM1 = 1, 10 λշ8λݣ
  38   1                      SM2 : Ϊ 0
  39   1                      REN = 1 : ݽʹλ
  40   1                      λĬΪ 0
  41   1              */
  42   1              SCON=0X50;      //ôڹʽΪ 1
  43   1              
  44   1              /* 
  45   1                      PCON ԴƼĴ 
  46   1                      λ SMOD : Ϊ 1 ʱʼӱ
  47   1                      ѡʼӱ
  48   1              */
  49   1              PCON=0X80;      
  50   1              
  51   1              TH1=baud;       //ʼֵ (ôּ) 
  52   1              TL1=baud; // ڹʽ, TL1  TH1 
  53   1              ES = 1;         // SCON Ĵж
C51 COMPILER V9.54   MAIN                                                                  05/06/2024 11:29:45 PAGE 2   

  54   1              EA = 1;         //ж
  55   1              TR1 = 1;                //򿪼            
  56   1      }
  57          
  58          
  59          void main()
  60          {       
  61   1              uart_init(0XFA); //Ϊ9600 51ʼ.exe 
  62   1      
  63   1              while(1)
  64   1              {                       
  65   2                                                              
  66   2              }               
  67   1      }
  68          
  69          // RI ܿ
  70          // TI Ϳ
  71          void uart() interrupt 4 //ͨжϺ
  72          {
  73   1              u8 rec_data;
  74   1              RI = 0;                 // жϱ־λ
  75   1              rec_data = SBUF; // 洢յ
  76   1              SBUF = rec_data; // յݷ뵽ͼĴ
  77   1              while(!TI);              // ȴ
  78   1              TI=0;                    // ɱ־λ                          
  79   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =     50    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
